{% extends 'experiments/base.html' %}
{% load static %}

{% block content %}






<section class="slider-section">
    {% if slides %}
    <link rel="stylesheet" href="{% static 'experiments/slider.css' %}">
    <div class="slider-container">
        <div class="slider-wrapper" id="sliderWrapper">
            {% for slide in slides %}
            <div class="slide">
                {% if slide.image %}
                <img src="{{ slide.image.url }}" alt="{{ slide.title }}">
                {% else %}
                <!-- Placeholder if image is missing, though model makes it required usually -->
                <div
                    style="height: 400px; background: #ddd; display: flex; align-items: center; justify-content: center;">
                    No Image</div>
                {% endif %}
                <div class="slide-caption">
                    <h2>{{ slide.title }}</h2>
                    <p>{{ slide.description }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
        <!-- Dots -->
        <div class="slider-dots" id="sliderDots">
            {% for slide in slides %}
            <span class="dot" data-index="{{ forloop.counter0 }}"></span>
            {% endfor %}
        </div>

        <!-- Arrows -->
        <button class="slider-arrow prev" id="prevSlide">&#10094;</button>
        <button class="slider-arrow next" id="nextSlide">&#10095;</button>
    </div>
    <script src="{% static 'experiments/slider.js' %}"></script>
    {% endif %}
</section>

<section id="experiments-section" class="experiments-container">
    <h2 class="section-title">قائمة التجارب العلمية</h2>
    <p class="section-subtitle">اختر تجربة للبدء في المحاكاة التفاعلية</p>

    <!-- Subject Filters -->
    <div class="subject-filters" style="text-align: center; margin-bottom: 30px;">
        <a href="{% url 'experiment_list' %}#experiments-section" class="filter-btn"
            style="margin: 5px; padding: 8px 20px; border-radius: 20px; text-decoration: none; border: 1px solid #ddd; color: {% if not current_subject %}white{% else %}#555{% endif %}; background-color: {% if not current_subject %}#3498db{% else %}#f8f9fa{% endif %}; display: inline-block; transition: all 0.3s ease;">
            الكل
        </a>
        {% for subject in subjects %}
        <a href="{% url 'experiment_list' %}?subject={{ subject.slug }}#experiments-section" class="filter-btn"
            style="margin: 5px; padding: 8px 20px; border-radius: 20px; text-decoration: none; border: 1px solid #ddd; color: {% if current_subject == subject.slug %}white{% else %}#555{% endif %}; background-color: {% if current_subject == subject.slug %}#3498db{% else %}#f8f9fa{% endif %}; display: inline-block; transition: all 0.3s ease;">
            {% if subject.icon %}
            <img src="{{ subject.icon.url }}" alt=""
                style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;">
            {% endif %}
            {{ subject.name }}
        </a>
        {% endfor %}
    </div>

    <!-- Experiments Grid -->
    <div class="cards-grid" id="cards-grid">
        {% for experiment in experiments %}
        <div class="card">
            <div style="position: relative;">
                {% if experiment.image %}
                <img src="{{ experiment.image.url }}" alt="{{ experiment.title }}" class="card-img">
                {% else %}
                <img src="https://via.placeholder.com/500x300?text={{ experiment.title }}" alt="{{ experiment.title }}"
                    class="card-img">
                {% endif %}

                {% if experiment.subject %}
                <span
                    style="position: absolute; top: 10px; right: 10px; background-color: rgba(52, 152, 219, 0.9); color: white; padding: 4px 10px; border-radius: 15px; font-size: 0.8rem;">
                    {{ experiment.subject.name }}
                </span>
                {% endif %}
            </div>

            <div class="card-body">
                <h3 class="card-title">{{ experiment.title }}</h3>
                <p class="card-desc">{{ experiment.description|truncatechars:100 }}</p>
                <a href="{% url 'experiment_detail' experiment.slug %}" class="card-btn">تفاصيل التجربة &#9654;</a>
            </div>
        </div>
        {% empty %}
        <div
            style="grid-column: 1/-1; text-align: center; padding: 40px; background-color: #f8f9fa; border-radius: 10px;">
            <p style="font-size: 1.2rem; color: #7f8c8d;">لا توجد تجارب متاحة في هذا القسم حالياً.</p>
            <a href="{% url 'experiment_list' %}" class="main-btn"
                style="background-color: #95a5a6; margin-top: 20px;">العودة لجميع التجارب</a>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}